"function populate_t_id2name_table(url, selector){"
	"get_json(url, function(data){"
		"var s = \"\";"
		"for (const [id, tpl] of Object.entries(data)){"
			"s +="
				  "\"<div class='tr'><div class='td'>\""
				"+ display_tag(id, tpl)"
				"+ \"</div></div>\""
			";"
		"}"
		"document.querySelector(selector).innerHTML = s;"
	"});"
"}"
"function populate_t_table(url, selector){"
	"get_json(url, function(data){"
		"var s = \"\";"
		"for (var tagid of data){"
			"s +="
				"\""
				"<div class='tr'>"
				"<div class='td'>"
				"\" + tagid + \"</div></div>\""
			";"
		"}"
		"document.querySelector(selector).innerHTML = s;"
		"column_id2name('/a/t.json', selector, '/t#', 0);"
	"});"
"}"
"function set_tag_name_from_id(id, selector){"
	"get_json('/a/t.json', function(data){"
		"document.querySelector(selector).innerText = data[id][0];"
	"});"
"}"
"function set_tag_thumb_from_id(id, selector){"
	"get_json('/a/t.json', function(data){"
		"document.querySelector(selector).src = data[id][1];"
	"});"
"}"
"function set_tag_cover_from_id(id, selector){"
	"get_json('/a/t.json', function(data){"
		"document.querySelector(selector).src = data[id][2];"
	"});"
"}"
"function populate_tagselects(){"
	"get_json(\"/a/t.json\", function(data){"
		"var s = \"\";"
		"for (const [id, tpl] of Object.entries(data)){"
			"s += \"<option value='\" + id + \"'>\" + tpl[0] + \"</option>\";"
		"}"
		"$(\".tagselect\").html(s).select2();" // Initialise
	"});"
"}"

"function display_tag(id, tpl){"
	"return \"<div class='user'><img src='\" + tpl[1] + \"' class='icon'/><div class='username'><a href='/t#\" + id + \"'>\" + tpl[0] + \"</a></div></div>\";"
"}"
"function display_tags(t, tag_ids, selector){"
	"const arr = tag_ids.map(x => display_tag(x, t[x]));"
	"document.querySelector(selector).innerHTML = arr.join(\"<br/>\");"
"}"
"function display_parent_tags(tag_id, selector){"
	// Similar to display_parent_dirs
	"get_json('/a/t2p.json', function(t2p){"
		"get_json('/a/t.json', function(t){"
			"display_tags(t, t2p.filter(x => (x[0] == tag_id)).map(x => x[1]), selector);"
		"});"
	"});"
"}"
"function display_child_tags(tag_id, selector){"
	"get_json('/a/t2p.json', function(t2p){"
		"get_json('/a/t.json', function(t){"
			"display_tags(t, t2p.filter(x => (x[1] == tag_id)).map(x => x[0]), selector);"
		"});"
	"});"
"}"

"function add_child_tags(tag_id, selector){"
	"const tagselect = $(selector);"
	"$.post({"
		"url: \"/t/c/\" + tag_id + \"/\" + tagselect.val().join(\",\"),"
		"success: function(){"
			"tagselect.val(\"\").change();" // Deselect all
		"},"
		"error: function(){"
			"alert(\"Error adding child tags\");"
		"}"
	"});"
"}"
"function add_parent_tags(tag_id, selector){"
	"const tagselect = $(selector);"
	"$.post({"
		"url: \"/t/p/\" + tag_id + \"/\" + tagselect.val().join(\",\"),"
		"success: function(){"
			"tagselect.val(\"\").change();" // Deselect all
		"},"
		"error: function(){"
			"alert(\"Error adding child tags\");"
		"}"
	"});"
"}"
