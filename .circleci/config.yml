version: 2
jobs:
  build:
    docker:
      - image: notcompsky/tagem-compile-1:0.0.1

    steps:
      - checkout

      - run:
          name: libcompsky - Download
          command: 'git clone https://github.com/NotCompsky/libcompsky'
      - run:
          name: libcompsky - Build
          command: 'mkdir libcompsky/build  &&  cd libcompsky/build  &&  cmake ..  &&  make  &&  make install  &&  cd ../..'

      - run:
          name: tagem - Download
          command: 'git clone https://github.com/NotCompsky/tagem'
      - run:
          name: tagem - Build
          command: 'mkdir tagem/build  &&  cd tagem/build  &&  cmake .. -Dproxygen_root_DIR=../../proxygen -DMAX_CACHE_AGE=0 -DCMAKE_BUILD_TYPE=Release  &&  make server'
